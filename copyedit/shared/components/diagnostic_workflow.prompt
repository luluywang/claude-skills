# Diagnostic Question Workflow

**Purpose:** Standardized diagnostic questions for paper type identification and scope selection. Used by both referee and copyedit master prompts.

---

## Question Set 1: Paper Type Identification

```
Question: "What type of economics paper is this?"
Header: "Paper type"
MultiSelect: false
Options:
  - Label: "Type A: Intuitive topic, complex identification"
    Description: "E.g., EITC labor supply, neighborhood effects - readers know the outcome, challenge is credible identification"

  - Label: "Type B: Specialized topic needing context"
    Description: "E.g., securitization, advertising markets - need to explain institutions before question makes sense"

  - Label: "Type C: Methodological innovation"
    Description: "E.g., new econometric technique, novel measurement - contribution is HOW you answer question"

  - Label: "Type D: Theory applied to data"
    Description: "E.g., testing theoretical predictions, structural estimation - theory generates testable hypotheses"

  - Label: "Not sure / Mixed type"
    Description: "I'll help you determine the type based on your paper"
```

**If "Not sure" selected:** Ask follow-up questions:
- Can a smart undergrad understand your research question without specialized knowledge?
- What's your main contribution: new question, new data, new method, or new theory test?
- What do readers need most to understand your paper?

---

## Question Set 2: Scope and Files

```
Question: "Which files should I analyze?"
Header: "Scope"
MultiSelect: false
Options:
  - Label: "All .tex files in current directory"
    Description: "Full paper review (introduction, body sections, conclusion, appendices)"

  - Label: "Main paper only (exclude appendices)"
    Description: "Introduction and main body sections only"

  - Label: "Specific files only"
    Description: "I'll specify which files to review"
```

**If "Specific files only":** Ask which files to include.

---

## Question Set 2.5: Reflow Option (Copyedit Only)

```
Question: "Would you like me to reflow your .tex files first?"
Header: "Reflow"
MultiSelect: false
Options:
  - Label: "No, keep current formatting"
    Description: "Leave line breaks as they are"

  - Label: "Yes, one sentence per line"
    Description: "Improves readability for editing and version control (recommended for collaborative work)"
```

**Note:** Reflow runs before other tasks. It preserves abbreviations and skips math environments.

---

## Question Set 2.6: LLM Tagging (Copyedit Only, .tex Files)

```
Question: "Wrap LLM changes in \\begin{llm}...\\end{llm} for review tracking?"
Header: "LLM tagging"
MultiSelect: false
Options:
  - Label: "Yes (Recommended)"
    Description: "Easier to identify and batch-review changes"

  - Label: "No"
    Description: "Apply changes directly without tagging"
```

**Note:** Only show this question for .tex files. When enabled, all LLM-made changes are wrapped in `\begin{llm}...\end{llm}` blocks, making them easy to identify during review. Tags can be stripped later with the `strip_llm` task.

---

## Question Set 3: Task Confirmation

**Note:** Detailed task preview with full table is shown in Step 4.5 after task enumeration. This question set is deprecated for copyedit workflow.

---

## Mixed Paper Type Handling

If paper type appears mixed or user selects "Not sure," use AskUserQuestion to clarify:

```
Question: "Your paper seems to combine types. Which aspect should drive the analysis?"
Header: "Primary focus"
MultiSelect: false
Options:
  - Label: "Identification strategy clarity (Type A)"
    Description: "Focus on whether causal identification is clearly explained and defended"

  - Label: "Institutional context explanation (Type B)"
    Description: "Focus on whether specialized context is sufficiently explained for general readers"

  - Label: "Methodological innovation (Type C)"
    Description: "Focus on whether the new method's intuition is clear before technical details"

  - Label: "Theory-to-data mapping (Type D)"
    Description: "Focus on whether theoretical predictions connect clearly to empirical tests"
```

After selection:
1. Load the primary type overlay
2. Note secondary characteristics in analysis
3. Flag places where secondary type considerations apply
